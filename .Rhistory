knitr::opts_chunk$set(echo = TRUE)
dataset <- read.csv("expenses.csv")
View(dataset)
library(tidyverse)
library(dplyr)
library(ggplot2)
dataset <- read.csv("expenses.csv")
fullmodel <- lm(expenses ~ ., data = dataset)
fullmodel <- lm(charges ~ ., data = dataset)
summary(fullmodel)
reducedmodel <- lm(charges ~ age, bmi, children, smoker, data = dataset)
View(dataset)
dataset
reducedmodel <- lm(charges ~ age, bmi, children, smoker, data = dataset)
reducedmodel <- lm(charges ~ age + bmi + children + smoker, data = dataset)
summary(reducedmodel)
summary(fullmodel)
dataset
reducedmodel <- lm(charges ~ age + bmi + children + smoker, data = dataset)
summary(reducedmodel)
summary(fullmodel)
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(dplyr)
library(ggplot2)
dataset <- read.csv("expenses.csv")
dataset <- dataset %>%
mutate(sex = as.factor(sex),
smoker = as.factor(smoker),
region = as.factor(region))
dataset1 <- read.csv("twitchdata-updata.csv")
library(tidyverse)
library(dplyr)
library(ggplot2)
dataset <- read.csv("expenses.csv")
dataset <- dataset %>%
mutate(sex = as.factor(sex),
smoker = as.factor(smoker),
region = as.factor(region))
dataset1 <- read.csv("twitchdata-update.csv")
View(dataset1)
dataset1 %>%
keep(is.numeric) -> dataset_quantitative1
View(dataset1)
glimpse(dataset1)
dataset1 %>%
keep(is.numeric) -> dataset_quantitative1
df <- data.frame(dataset_quantitative[, c("Watch.time.Minutes.", "Stream.time.minutes.", "Peak.viewers", "Average.viewers", "Followers", "Followers.gained", "Views.gained")])
dataset1 %>%
keep(is.numeric) -> dataset_quantitative1
df <- data.frame(dataset_quantitative1[, c("Watch.time.Minutes.", "Stream.time.minutes.", "Peak.viewers", "Average.viewers", "Followers", "Followers.gained", "Views.gained")])
datarows <- nrow(df)
y_mat <- as.matrix(df)[, 7]
x1 <- df[, 1]
x2 <- df[, 2]
x3 <- df[, 3]
x4 <- df[, 4]
x5 <- df[, 5]
x6 <- df[, 6]
Ym <- matrix(y_mat, ncol = 1, byrow = T)
y_int <- data.frame(matrix(nrow = datarows, ncol = 1))
for(i in seq(1:datarows)){
y_int[i, 1] = 1
}
df <- data_frame(y_int, x1, x2, x3, x4, x5, x6)
Xm <- cbind(rep(1, datarows), as.matrix(df[, 1]), as.matrix(df[, 2]), as.matrix(df[, 3]),as.matrix(df[, 4]), as.matrix(df[, 5]), as.matrix(df[, 6]))
# Lets find the transpose of matrix Xm
t(Xm) -> transposeXm
# The product of Xm and the transpose of Xm
transposeXm%*%Xm-> ProDuct1
# Inverse of the matrix * transpose * Y
solve(ProDuct1)%*%transposeXm%*%Ym
Ym <- matrix(dataset_quantitatve1$Views.gained, ncol = 1, byrow = TRUE)
Ym <- matrix(dataset_quantitative1$Views.gained, ncol = 1, byrow = TRUE)
#Ym
X <- c()
for(i in 1:length(dataset_quantitative1)){
X <- append(X, 1)
X <- append(X, dataset_quantitative1$Watch.time.Minutes.[i])
X <- append(X, dataset_quantitative1$Stream.time.minutes.[i])
X <- append(X, dataset_quantitative1$Peak.viewers[i])
X <- append(X, dataset_quantitative1$Average.viewers[i])
X <- append(X, dataset_quantitative1$Followers[i])
X <- append(X, dataset_quantitative1$Followers.gained[i])
}
Xm <- matrix(X, ncol = 7, byrow = TRUE)
interceptslope <- solve(t(Xm)%*% Xm)%*%t(Xm)%*%Ym
Ym <- matrix(dataset_quantitative1$Views.gained, ncol = 1, byrow = TRUE)
#Ym
X <- c()
for(i in 1:length(dataset_quantitative1)){
X <- append(X, 1)
X <- append(X, dataset_quantitative1$Watch.time.Minutes.[i])
X <- append(X, dataset_quantitative1$Stream.time.minutes.[i])
X <- append(X, dataset_quantitative1$Peak.viewers[i])
X <- append(X, dataset_quantitative1$Average.viewers[i])
X <- append(X, dataset_quantitative1$Followers[i])
}
Xm <- matrix(X, ncol = 6, byrow = TRUE)
interceptslope <- solve(t(Xm)%*% Xm)%*%t(Xm)%*%Ym
Ym <- matrix(dataset_quantitative1$Views.gained, ncol = 1, byrow = TRUE)
#Ym
X <- c()
for(i in 1:length(dataset_quantitative1)){
X <- append(X, 1)
X <- append(X, dataset_quantitative1$Watch.time.Minutes.[i])
X <- append(X, dataset_quantitative1$Stream.time.minutes.[i])
X <- append(X, dataset_quantitative1$Peak.viewers[i])
X <- append(X, dataset_quantitative1$Average.viewers[i])
}
Xm <- matrix(X, ncol = 5, byrow = TRUE)
interceptslope <- solve(t(Xm)%*% Xm)%*%t(Xm)%*%Ym
Ym <- matrix(dataset_quantitative1$Views.gained, ncol = 1, byrow = TRUE)
#Ym
X <- c()
for(i in 1:length(dataset_quantitative1)){
X <- append(X, 1)
X <- append(X, dataset_quantitative1$Watch.time.Minutes.[i])
X <- append(X, dataset_quantitative1$Stream.time.minutes.[i])
X <- append(X, dataset_quantitative1$Peak.viewers[i])
X <- append(X, dataset_quantitative1$Average.viewers[i])
}
Xm <- matrix(X, ncol = 5, byrow = TRUE)
solve(t(Xm)%*% Xm)
Ym <- matrix(dataset_quantitative1$Views.gained, ncol = 1, byrow = TRUE)
#Ym
X <- c()
for(i in 1:length(dataset_quantitative1)){
X <- append(X, 1)
X <- append(X, dataset_quantitative1$Watch.time.Minutes.[i])
X <- append(X, dataset_quantitative1$Followers[i])
X <- append(X, dataset_quantitative1$Peak.viewers[i])
X <- append(X, dataset_quantitative1$Average.viewers[i])
}
Xm <- matrix(X, ncol = 5, byrow = TRUE)
solve(t(Xm)%*% Xm)
